#!/usr/bin/env python
# coding: utf-8

# In[1]:


import numpy as np
import matplotlib.pyplot as plt

Radius = np.array([0.181,0.143,0.135,0.241])
Tsquared = np.array([1.59,1.19,1.10,1.76])

err_Tsquared = np.array([0.06,0.026,0.040,0.0189])

x = Radius   
y = Tsquared
dy = err_Tsquared

b,m=np.polynomial.polynomial.polyfit(x,y,1,w=dy)
fit = b+m*x

def Delta(x, dy):
    D = (sum(1/dy**2))*(sum(x**2/dy**2))-(sum(x/dy**2))**2
    return D

D=Delta(x, dy)
 
dm = np.sqrt(1/D*sum(1/dy**2)) 
db = np.sqrt(1/D*sum(x**2/dy**2)) 


def LLSFD2(x,y,dy):
    N = sum(((y-b-m*x)/dy)**2)
    return N
                      
N = LLSFD2(x,y,dy)

plt.figure(figsize=(15,10))
 
plt.plot(x, fit, color='green', linestyle='--')
plt.scatter(x, y, color='blue', marker='o')

plt.xlabel('Radius')
plt.ylabel('Tsquared')
plt.title('Centripital Force Plot')

plt.errorbar(x, y, yerr=dy, xerr=None, fmt="none") 
 
plt.annotate('Slope (s^2/m) = {value:.{digits}E}'.format(value=m, digits=2),
             (0.05, 0.9), xycoords='axes fraction')
 
plt.annotate('Error in Slope (s^2/m) = {value:.{digits}E}'.format(value=dm, digits=1),
             (0.05, 0.85), xycoords='axes fraction')
 
plt.annotate('Goodness of fit = {value:.{digits}E}'.format(value=N, digits=2),
             (0.05, 0.80), xycoords='axes fraction')

plt.show()


# In[ ]:




